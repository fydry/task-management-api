<!DOCTYPE html>
<html lang="pl" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Task Tracker CLI - UI</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .task-list { margin-top: 30px; }
        .task { border: 1px solid #ccc; padding: 10px; margin-bottom: 10px; }
        .status-TODO { color: orange; font-weight: bold; }
        .status-IN_PROGRESS { color: blue; font-weight: bold; }
        .status-DONE { color: green; font-weight: bold; }
        .task-actions { margin-top: 10px; }
        .task-actions button { margin-right: 10px; padding: 5px 10px; border: 1px solid #ccc; border-radius: 4px; }
    </style>
</head>
<body>

<h1>Dodaj Nowe Zadanie</h1>

<form th:action="@{/tasks/add}" th:object="${newTask}" method="post">
    <div>
        <label for="title">Tytuł:</label>
        <input type="text" id="title" th:field="*{title}" required/>
    </div>
    <div>
        <label for="description">Opis:</label>
        <input type="text" id="description" th:field="*{description}"/>
    </div>
    <div>
        <button type="submit">Dodaj Zadanie</button>
    </div>
</form>

<hr/>

<h2>Lista Zadań</h2>

<div th:if="${tasks.empty}">
    <p>Brak zadań. Dodaj nowe!</p>
</div>

<div th:each="task : ${tasks}" th:classappend="'status-' + ${task.status}" class="task">
    <p>
        <strong>ID:</strong> <span th:text="${task.id}">1</span> |
        <strong>Tytuł:</strong> <span th:text="${task.title}">Przykładowe Zadanie</span>
    </p>
    <p>
        <strong>Status:</strong> <span th:text="${task.status}">TODO</span> |
        <strong>Opis:</strong> <span th:text="${task.description}">Opis zadania</span>
    </p>
    <p>
        <strong>Utworzone:</strong>
        <span th:text="${#temporals.format(task.createdAt, 'yyyy-MM-dd HH:mm')}">2025-01-01 12:00</span>
    </p>

    <div class="task-actions">

        <form th:if="${task.status.name() == 'TODO'}"
              th:action="@{/tasks/status/{id}(id=${task.id}, nextStatus='IN_PROGRESS')}"
              method="post"
              style="display: inline;">
            <button type="submit" style="color: blue;">Rozpocznij (IN PROGRESS)</button>
        </form>

        <form th:if="${task.status.name() == 'IN_PROGRESS'}"
              th:action="@{/tasks/status/{id}(id=${task.id}, nextStatus='DONE')}"
              method="post"
              style="display: inline;">
            <button type="submit" style="color: green;">Zakończ (DONE)</button>
        </form>

        <form th:if="${task.status.name() == 'DONE'}"
              th:action="@{/tasks/status/{id}(id=${task.id}, nextStatus='TODO')}"
              method="post"
              style="display: inline;">
            <button type="submit" style="color: orange;">Cofnij do TODO</button>
        </form>

        <form th:action="@{/tasks/delete/{id}(id=${task.id})}" method="post" style="display: inline;">
            <button type="submit" style="color: red;">Usuń</button>
        </form>

    </div>
</div>

</body>
</html>